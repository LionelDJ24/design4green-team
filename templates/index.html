<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Design for Green - R√©sumeur</title>

     <--On lie le fichier CSS externe -->
    <link rel="stylesheet" href="{{ url_for('static', filename='static.css') }}">
</head>
<body>
    <div class="container">
        <h1>üå± R√©sumeur √âco-Responsable</h1>
        <p class="subtitle">Design for Green - R√©sum√© en 10-15 mots avec suivi √©nerg√©tique</p>
        
        <form id="summaryForm">
            <label for="textInput">Texte √† r√©sumer (max 4000 caract√®res)</label>
            <textarea 
                id="textInput" 
                placeholder="Saisissez ou collez votre texte ici..."
                maxlength="4000"
                required
            ></textarea>
            <div class="char-count">
                <span id="charCount">0</span> / 4000 caract√®res
            </div>
            
            <div class="mode-selector">
                <label>Mode de traitement</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="baseline" name="mode" value="false" checked>
                        <label for="baseline">Baseline (FP32)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="optimized" name="mode" value="true">
                        <label for="optimized">Optimis√© <span class="eco-badge">-50% √©nergie</span></label>
                    </div>
                </div>
            </div>
            
            <button type="submit" id="submitBtn">G√©n√©rer le r√©sum√©</button>
        </form>
	

        
        <div id="loading" class="loading hidden">
            <p>‚è≥ G√©n√©ration en cours...</p>
        </div>
        
        <div id="error" class="error hidden"></div>
        
        <div id="results" class="results hidden">
            <h2>üìù R√©sultat</h2>
            <div class="summary-text" id="summaryText"></div>
            
            <div class="metrics">
                <div class="metric-card">
                    <div class="metric-label">‚ö° √ânergie consomm√©e</div>
                    <div class="metric-value">
                        <span id="energyValue">-</span>
                        <span class="metric-unit">Wh</span>
                    </div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">‚è±Ô∏è Latence</div>
                    <div class="metric-value">
                        <span id="latencyValue">-</span>
                        <span class="metric-unit">ms</span>
                    </div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">üîß Mode</div>
                    <div class="metric-value" style="font-size: 1.2rem;">
                        <span id="modeValue">-</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Script JavaScript pour le fonctionnement -->
    <script>
        const textInput = document.getElementById('textInput');
        const charCount = document.getElementById('charCount');
        const form = document.getElementById('summaryForm');
        const submitBtn = document.getElementById('submitBtn');
        const loading = document.getElementById('loading');
        const results = document.getElementById('results');
        const error = document.getElementById('error');

        textInput.addEventListener('input', () => {
            charCount.textContent = textInput.value.length;
        });

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const text = textInput.value.trim();
            const optimized = document.querySelector('input[name="mode"]:checked').value === 'true';

            if (!text) {
                showError('Veuillez saisir un texte');
                return;
            }

            hideError();
            hideResults();
            showLoading();
            submitBtn.disabled = true;

            try {
                const response = await fetch('/summarize', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text, optimized })
                });
                
                const data = await response.json();
                if (!response.ok) throw new Error(data.error || 'Erreur lors de la g√©n√©ration');
                displayResults(data);
            } catch (err) {
                showError(err.message);
            } finally {
                hideLoading();
                submitBtn.disabled = false;
            }
        });

        function displayResults(data) {
            document.getElementById('summaryText').textContent = data.summary;
            document.getElementById('energyValue').textContent = data.energy_wh.toFixed(6);
            document.getElementById('latencyValue').textContent = data.latency_ms.toFixed(2);
            document.getElementById('modeValue').textContent = data.mode;
            results.classList.remove('hidden');
        }

        function showLoading() { loading.classList.remove('hidden'); }
        function hideLoading() { loading.classList.add('hidden'); }
        function showError(message) {
            error.textContent = '‚ùå ' + message;
            error.classList.remove('hidden');
        }
        function hideError() { error.classList.add('hidden'); }
        function hideResults() { results.classList.add('hidden'); }
    </script>
</body>
</html>
